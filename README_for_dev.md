# База данных 
1. Объектная модель данных представленна по [ссылке](https://github.com/gluman/VKinder_AG_ES/blob/main/DB/VKinderDB%20-%20public.png)
2. База данных называется VKinderDB, СУБР PostgreSQL 15. root пользователь БД: postgre:123
3. Create_Tables.sql - создвание структуры БД, Drop_Tables.sql - удаление всех данных из БД.
4. person - таблица с информацией о текущем пользователе, с кем взаимодействует бот
5. partners - таблица с найденными людьми
6. partners_photos - таблица с фотографиями найденных людей
7. В Settings.py необходимо внести параметры подключения к БД: 
   db_host = 'localhost', db_name = 'VKinderD', db_user = 'postgres', db_pass = '123')


# Приложение. 
1. Состоит из основного модуля main.py.
2. для взаимодействия с БД используется модуль db_connect.py.
3. Для взаимодействия с VK используется модуль vkbot_connect.py
4. Обращение в функциям в db_connect.py идет в основном напрямую.
5. Обращение к функицям и методам VK идет через промежуточные функции в main.py
6. Вся основная логика реализована либо в цикле отслеживания ввода, либо в промежуточных функциях в модуле main.

# Описание основных функций приложения:
## Выыод справки
    Команда help. Просто ввыводит построчно доступные команды. 
## Ввод ключа пользователя VK
    Команда token. Требуется для поиска людей в VK. Поиск происходит от имени пользователя и его токена
## Поиск людей по критериям
    Команда find. Дополнительно заправшивает с пользователя возраст для поиска, пол и 
    город поиска (город проживания человека).
    После этого происходит обращение методом от VK.
    В выбору попадают люди в 10 раз больше требуемого(count_filtred_search in Settings) количества 
      в т.ч. с закрытми профилями.
    Далее данная выборка фильтруется и остается уже 3 человека с открытими профилями. 
    Найденные люди записываются в БД. 
    По найденным людям осуществляется поиск фотографий. Отбираются 3 фото с набольшим количеством лайков.
    Запись в БД осуществляется через промежуточное сохранение фотографий в папке Tempary_saved_photos, 
      в которой отдельно создаются папки для каждого пользователя. 
    После записи фотографий в БД временная папка очищается. 
## Просмотр людей из БД
    Команда show. Далее запрашивается фильтр для просмотра (top - только избранное, all - все).
    Запрос к БД формируется динамически, в зависимости от фильтра корректируется текст запроса. 
    Информация по человеку выводится в заданом формате.
    Вывод фотографий осуществляется поочередно. 
    По каждому человеку можно - добавить в избранное (add), удалить из избранно (rem), удалить из БД(del), 
    next - перейти к следующему человеку
## Изменение признаков
    add - обновляет признак favorite в БД, устанавливает его в True
    rem - обновляет признак favorite в БД, устанавливает его в False
    del - Удаляет сначала из таблицы partners_photos записи где id_partner - текущий найденный человек, 
         далее удалет из таблицы partners запись где id_partner - текущий найденный человек.
    next - переход следующему человеку в выборке, при этом увеличивается index в списке, соотвутсвующий выборке.
    
    


    